<!DOCTYPE html>
<html>

<head>
    <title>Semantic Outfit Search</title>
    <style>
        body {
            font-family: Arial;
            padding: 2em;
        }

        #results img {
            max-width: 90px;
            margin-top: 0.5em;
        }

        #results li {
            margin-bottom: 2em;
        }
    </style>
</head>

<body>
    <h1>Semantic Fashion Search</h1>
    <form id="searchForm">
        <input type="text" id="query" style="width: 50ch;"
            placeholder="Try: I need an outfit for a summer beach trip" />
        <button type="submit">Search</button>
    </form>
    <div id="results"></div>
    <script>
        document.getElementById('searchForm').onsubmit = async function (e) {
            e.preventDefault();
            let query = document.getElementById('query').value;
            document.getElementById('results').innerText = "Loading...";
            try {
                let resp = await fetch(`/recommendations?query=${encodeURIComponent(query)}`);
                let data = await resp.json();
                console.log(data)
                if (data.ok) {
                    let html = `<p><strong>User Query:</strong> ${data.user_query}</p><ul>`;
                    for (let item of data.results) {
                        html += `
                          <li>
                            <p><strong>${item.title || "Untitled"}</strong></p>
                            <p><em>Store:</em> ${item.store || "Unknown"}</p>
                            <p><em>Rating:</em> ${item.average_rating} ‚≠ê (${item.rating_number})</p>
                            ${item.main_hi_res_image ? `<img src="https://m.media-amazon.com/images/I/${item.main_hi_res_image}" alt="Product image">` : ''}
                          </li>
                        `;
                    }
                    html += "</ul>";
                    document.getElementById('results').innerHTML = html;
                } else {
                    document.getElementById('results').innerText = data.error || "An unknown error occurred.";
                }
            } catch (err) {
                document.getElementById('results').innerText = `An error occurred: ${err.message}`;
            }
        };
    </script>
</body>

</html>